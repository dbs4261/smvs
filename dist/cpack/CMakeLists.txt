# CPack Settings

set(CPACK_PACKAGE_NAME "mve")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "URCVentures Customized Shading Aware Multi-View Stereo")
set(CPACK_PACKAGE_VENDOR "URCVentures")
set(CPACK_PACKAGE_CONTACT "Dan.Simon@stockpilereports.com")
set(CPACK_RESOURCE_FILE_README "${CMAKE_CURRENT_LIST_DIR}/../../README.md")
set(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_CURRENT_LIST_DIR}/../../LICENSE")

set(CPACK_COMPONENT_SMVS_DEVELOPMENT_DEPENDS SMVS_Runtime)
set(CPACK_COMPONENT_SMVS_APPLICATIONS_DEPENDS SMVS_Runtime)
set(CPACK_COMPONENT_SMVS_TOOLS_DEPENDS SMVS_Runtime)
set(CPACK_COMPONENT_SMVS_GUI_RUNTIME_DEPENDS SMVS_Runtime)

if(UNIX AND NOT APPLE)
    set(CPACK_GENERATOR "TGZ")
    find_program(DPKG_CMD dpkg)
    if (DPKG_CMD)
        list(APPEND CPACK_GENERATOR "DEB")
        execute_process(COMMAND "${DPKG_CMD}" --print-architecture
            OUTPUT_VARIABLE CPACK_DEBIAN_PACKAGE_ARCHITECTURE
            OUTPUT_STRIP_TRAILING_WHITESPACE)
        set(CPACK_DEBIAN_PACKAGE_MAINTAINER "Daniel Simon")
        set(CPACK_DEB_COMPONENT_INSTALL ON)
        set(CPACK_DEBIAN_PACKAGE_SECTION "Libraries")
        set(CPACK_DEBIAN_PACKAGE_CONTROL_STRICT_PERMISSION ON)
        set(CPACK_DEBIAN_ENABLE_COMPONENT_DEPENDS ON)
        set(CPACK_DEBIAN_PACKAGE_SHLIBDEPS ON)
        set(CPACK_DEBIAN_FILE_NAME "DEB-DEFAULT")
        set(CPACK_DEBIAN_SMVS_DEVELOPMENT_PACKAGE_NAME "libsmvs-dev")
        set(CPACK_DEBIAN_SMVS_RUNTIME_PACKAGE_NAME "libsmvs")
        set(CPACK_DEBIAN_SMVS_APPLICATIONS_PACKAGE_NAME "smvs-apps")
        set(CPACK_DEBIAN_SMVS_TOOLS_PACKAGE_NAME "smvs-tools")
    else()
        message(STATUS "DEB Package will not be generated as dpkg was not found")
    endif()

    find_program(RPMBUILD_CMD rpmbuild)
    if (RPMBUILD_CMD)
        list(APPEND CPACK_GENERATOR "RPM")
        set(CPACK_RPM_PACKAGE_LICENSE "BSD3")
        set(CPACK_RPM_PACKAGE_GROUP "Development/Libraries")
        set(CPACK_RPM_PACKAGE_VENDOR "URCVentures")
        set(CPACK_RPM_COMPONENT_INSTALL ON)
        set(CPACK_RPM_PACKAGE_AUTOREQPROV 1)
        set(CPACK_RPM_FILE_NAME "RPM-DEFAULT")
        set(CPACK_RPM_SMVS_DEVELOPMENT_PACKAGE_NAME "smvs-devel")
        set(CPACK_RPM_SMVS_RUNTIME_PACKAGE_NAME "smvs-libs")
        set(CPACK_RPM_SMVS_APPLICATIONS_PACKAGE_NAME "smvs")
        set(CPACK_RPM_SMVS_TOOLS_PACKAGE_NAME "smvs-tools")
    else()
        message(STATUS "RPM Package will not be generated as rpmbuild was not found")
    endif()
else()
    message(WARNING "This cmake script has not been setup for packaging on Apple or Windows platforms.")
endif()

message(STATUS "CPACK Generators: ${CPACK_GENERATOR}")
set(CPACK_ARCHIVE_COMPONENT_INSTALL ON)
set(CPACK_COMPONENTS_GROUPING ONE_PER_GROUP)

include(CPack)
